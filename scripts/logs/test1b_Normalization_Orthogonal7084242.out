2025-06-30 01:39:03,255 - INFO - Starting training for task: sst2
2025-06-30 01:39:03,256 - INFO - Config: CFG(model_name='bert-base-uncased', tasks=['sst2', 'qnli'], train_size=2000, eval_size=500, device='cuda', epochs=2, batch_train=16, batch_eval=32)
2025-06-30 01:39:03,307 - INFO - CUDA available: Quadro RTX 8000
2025-06-30 01:39:03,582 - INFO - Tokenizer loaded successfully
2025-06-30 01:39:03,583 - INFO - Loading dataset: glue/sst2
2025-06-30 01:39:05,309 - INFO - Dataset loaded. Train size: 67349, Val size: 872
2025-06-30 01:39:05,357 - INFO - Data preprocessing complete. Train samples: 2000, Val samples: 500
2025-06-30 01:39:05,358 - INFO - Loading model: bert-base-uncased
2025-06-30 01:39:08,119 - INFO - Model loaded and moved to device: cuda
2025-06-30 01:39:08,120 - INFO - Setting up training arguments
2025-06-30 01:39:08,214 - INFO - Setting up trainer
2025-06-30 01:39:08,249 - INFO - Starting training...
{'loss': 0.7061, 'grad_norm': 1.9277856349945068, 'learning_rate': 4.82e-05, 'epoch': 0.08}
{'loss': 0.6645, 'grad_norm': 2.7670159339904785, 'learning_rate': 4.6200000000000005e-05, 'epoch': 0.16}
{'loss': 0.5027, 'grad_norm': 8.622726440429688, 'learning_rate': 4.4200000000000004e-05, 'epoch': 0.24}
{'loss': 0.3865, 'grad_norm': 34.30144119262695, 'learning_rate': 4.22e-05, 'epoch': 0.32}
{'loss': 0.459, 'grad_norm': 3.6474010944366455, 'learning_rate': 4.02e-05, 'epoch': 0.4}
{'loss': 0.3884, 'grad_norm': 16.854963302612305, 'learning_rate': 3.82e-05, 'epoch': 0.48}
{'loss': 0.3727, 'grad_norm': 16.343660354614258, 'learning_rate': 3.62e-05, 'epoch': 0.56}
{'loss': 0.3111, 'grad_norm': 13.047649383544922, 'learning_rate': 3.4200000000000005e-05, 'epoch': 0.64}
{'loss': 0.3304, 'grad_norm': 8.582558631896973, 'learning_rate': 3.2200000000000003e-05, 'epoch': 0.72}
{'loss': 0.3307, 'grad_norm': 22.394760131835938, 'learning_rate': 3.02e-05, 'epoch': 0.8}
{'loss': 0.2738, 'grad_norm': 21.92748260498047, 'learning_rate': 2.8199999999999998e-05, 'epoch': 0.88}
{'loss': 0.4637, 'grad_norm': 19.19989776611328, 'learning_rate': 2.6200000000000003e-05, 'epoch': 0.96}
{'eval_loss': 0.31988292932510376, 'eval_accuracy': 0.87, 'eval_runtime': 0.4976, 'eval_samples_per_second': 1004.828, 'eval_steps_per_second': 32.154, 'epoch': 1.0}
{'loss': 0.2521, 'grad_norm': 1.0080732107162476, 'learning_rate': 2.4200000000000002e-05, 'epoch': 1.04}
{'loss': 0.1299, 'grad_norm': 3.048635482788086, 'learning_rate': 2.22e-05, 'epoch': 1.12}
{'loss': 0.2577, 'grad_norm': 9.883106231689453, 'learning_rate': 2.0200000000000003e-05, 'epoch': 1.2}
{'loss': 0.26, 'grad_norm': 18.098365783691406, 'learning_rate': 1.8200000000000002e-05, 'epoch': 1.28}
{'loss': 0.1946, 'grad_norm': 1.8842180967330933, 'learning_rate': 1.62e-05, 'epoch': 1.36}
{'loss': 0.2036, 'grad_norm': 15.66819953918457, 'learning_rate': 1.42e-05, 'epoch': 1.44}
{'loss': 0.184, 'grad_norm': 11.851747512817383, 'learning_rate': 1.22e-05, 'epoch': 1.52}
{'loss': 0.1249, 'grad_norm': 15.256447792053223, 'learning_rate': 1.02e-05, 'epoch': 1.6}
{'loss': 0.1831, 'grad_norm': 5.033034801483154, 'learning_rate': 8.200000000000001e-06, 'epoch': 1.68}
{'loss': 0.0956, 'grad_norm': 24.215572357177734, 'learning_rate': 6.2e-06, 'epoch': 1.76}
{'loss': 0.1805, 'grad_norm': 11.348732948303223, 'learning_rate': 4.2000000000000004e-06, 'epoch': 1.84}
{'loss': 0.1512, 'grad_norm': 12.925182342529297, 'learning_rate': 2.2e-06, 'epoch': 1.92}
{'loss': 0.1198, 'grad_norm': 13.377628326416016, 'learning_rate': 2.0000000000000002e-07, 'epoch': 2.0}
{'eval_loss': 0.3729308247566223, 'eval_accuracy': 0.892, 'eval_runtime': 0.4779, 'eval_samples_per_second': 1046.201, 'eval_steps_per_second': 33.478, 'epoch': 2.0}
{'train_runtime': 17.9454, 'train_samples_per_second': 222.899, 'train_steps_per_second': 13.931, 'train_loss': 0.30106037282943726, 'epoch': 2.0}
2025-06-30 01:39:26,379 - INFO - Training completed successfully
2025-06-30 01:39:26,548 - INFO - Model moved to CPU and training finished for task: sst2
2025-06-30 01:39:26,551 - INFO - Starting training for task: qnli
2025-06-30 01:39:26,551 - INFO - Config: CFG(model_name='bert-base-uncased', tasks=['sst2', 'qnli'], train_size=2000, eval_size=500, device='cuda', epochs=2, batch_train=16, batch_eval=32)
2025-06-30 01:39:26,552 - INFO - CUDA available: Quadro RTX 8000
2025-06-30 01:39:26,752 - INFO - Tokenizer loaded successfully
2025-06-30 01:39:26,753 - INFO - Loading dataset: glue/qnli
2025-06-30 01:39:27,963 - INFO - Dataset loaded. Train size: 104743, Val size: 5463
2025-06-30 01:39:28,005 - INFO - Data preprocessing complete. Train samples: 2000, Val samples: 500
2025-06-30 01:39:28,006 - INFO - Loading model: bert-base-uncased
2025-06-30 01:39:28,347 - INFO - Model loaded and moved to device: cuda
2025-06-30 01:39:28,348 - INFO - Setting up training arguments
2025-06-30 01:39:28,443 - INFO - Setting up trainer
2025-06-30 01:39:28,457 - INFO - Starting training...
{'loss': 0.7156, 'grad_norm': 4.185510158538818, 'learning_rate': 4.82e-05, 'epoch': 0.08}
{'loss': 0.6707, 'grad_norm': 8.785157203674316, 'learning_rate': 4.6200000000000005e-05, 'epoch': 0.16}
{'loss': 0.594, 'grad_norm': 4.079275131225586, 'learning_rate': 4.4200000000000004e-05, 'epoch': 0.24}
{'loss': 0.6035, 'grad_norm': 6.96248197555542, 'learning_rate': 4.22e-05, 'epoch': 0.32}
{'loss': 0.5417, 'grad_norm': 11.418680191040039, 'learning_rate': 4.02e-05, 'epoch': 0.4}
{'loss': 0.5277, 'grad_norm': 15.635701179504395, 'learning_rate': 3.82e-05, 'epoch': 0.48}
{'loss': 0.5814, 'grad_norm': 3.7475790977478027, 'learning_rate': 3.62e-05, 'epoch': 0.56}
{'loss': 0.5731, 'grad_norm': 8.747978210449219, 'learning_rate': 3.4200000000000005e-05, 'epoch': 0.64}
{'loss': 0.5049, 'grad_norm': 6.660214900970459, 'learning_rate': 3.2200000000000003e-05, 'epoch': 0.72}
{'loss': 0.5228, 'grad_norm': 9.119773864746094, 'learning_rate': 3.02e-05, 'epoch': 0.8}
{'loss': 0.5214, 'grad_norm': 5.414433002471924, 'learning_rate': 2.8199999999999998e-05, 'epoch': 0.88}
{'loss': 0.5342, 'grad_norm': 8.350957870483398, 'learning_rate': 2.6200000000000003e-05, 'epoch': 0.96}
{'eval_loss': 0.43188872933387756, 'eval_accuracy': 0.818, 'eval_runtime': 1.0262, 'eval_samples_per_second': 487.235, 'eval_steps_per_second': 15.592, 'epoch': 1.0}
{'loss': 0.4513, 'grad_norm': 4.300283432006836, 'learning_rate': 2.4200000000000002e-05, 'epoch': 1.04}
{'loss': 0.3948, 'grad_norm': 22.732988357543945, 'learning_rate': 2.22e-05, 'epoch': 1.12}
{'loss': 0.4117, 'grad_norm': 21.633926391601562, 'learning_rate': 2.0200000000000003e-05, 'epoch': 1.2}
{'loss': 0.3476, 'grad_norm': 4.3360724449157715, 'learning_rate': 1.8200000000000002e-05, 'epoch': 1.28}
{'loss': 0.3332, 'grad_norm': 8.840799331665039, 'learning_rate': 1.62e-05, 'epoch': 1.36}
{'loss': 0.3146, 'grad_norm': 4.462144374847412, 'learning_rate': 1.42e-05, 'epoch': 1.44}
{'loss': 0.3259, 'grad_norm': 8.326566696166992, 'learning_rate': 1.22e-05, 'epoch': 1.52}
{'loss': 0.3616, 'grad_norm': 10.69599723815918, 'learning_rate': 1.02e-05, 'epoch': 1.6}
{'loss': 0.3706, 'grad_norm': 9.018745422363281, 'learning_rate': 8.200000000000001e-06, 'epoch': 1.68}
{'loss': 0.2977, 'grad_norm': 5.6575798988342285, 'learning_rate': 6.2e-06, 'epoch': 1.76}
{'loss': 0.3131, 'grad_norm': 7.533969879150391, 'learning_rate': 4.2000000000000004e-06, 'epoch': 1.84}
{'loss': 0.3772, 'grad_norm': 13.022882461547852, 'learning_rate': 2.2e-06, 'epoch': 1.92}
{'loss': 0.3374, 'grad_norm': 4.831995964050293, 'learning_rate': 2.0000000000000002e-07, 'epoch': 2.0}
{'eval_loss': 0.3866531252861023, 'eval_accuracy': 0.844, 'eval_runtime': 1.0252, 'eval_samples_per_second': 487.707, 'eval_steps_per_second': 15.607, 'epoch': 2.0}
{'train_runtime': 29.1376, 'train_samples_per_second': 137.279, 'train_steps_per_second': 8.58, 'train_loss': 0.46110140323638915, 'epoch': 2.0}
2025-06-30 01:39:57,851 - INFO - Training completed successfully
2025-06-30 01:39:58,027 - INFO - Model moved to CPU and training finished for task: qnli
Orthogonal+Norm accuracies [0.892, 0.416] [0.506, 0.844] [0.89, 0.378]
CL {'BWT': -0.0020000000000000018, 'FWT': -0.03799999999999998, 'Retention%': 99.77578475336323, 'Transfer%': 90.86538461538461} {'BWT': -0.46599999999999997, 'FWT': 0.384, 'Retention%': 44.7867298578199, 'Transfer%': 175.8893280632411}

======== GPU REPORT ========

==============NVSMI LOG==============

Timestamp                                 : Mon Jun 30 01:40:08 2025
Driver Version                            : 570.133.20
CUDA Version                              : 12.8

Attached GPUs                             : 1
GPU 00000000:A4:00.0
    Accounting Mode                       : Enabled
    Accounting Mode Buffer Size           : 4000
    Accounted Processes
        Process ID                        : 776335
            GPU Utilization               : 63 %
            Memory Utilization            : 33 %
            Max memory usage              : 7510 MiB
            Time                          : 70585 ms
            Is Running                    : 0

Mon Jun 30 01:40:08 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.20             Driver Version: 570.133.20     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Quadro RTX 8000                On  |   00000000:A4:00.0 Off |                    0 |
| 41%   53C    P2             82W /  260W |       1MiB /  46080MiB |     70%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
