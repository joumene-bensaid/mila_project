2025-06-30 01:34:25,438 - INFO - Starting training for task: sst2
2025-06-30 01:34:25,439 - INFO - Config: CFG(model_name='bert-base-uncased', tasks=['sst2', 'qnli'], train_size=2000, eval_size=500, device='cuda', epochs=2, batch_train=16, batch_eval=32)
2025-06-30 01:34:25,486 - INFO - CUDA available: Quadro RTX 8000
2025-06-30 01:34:25,818 - INFO - Tokenizer loaded successfully
2025-06-30 01:34:25,819 - INFO - Loading dataset: glue/sst2
2025-06-30 01:34:28,168 - INFO - Dataset loaded. Train size: 67349, Val size: 872
2025-06-30 01:34:28,217 - INFO - Data preprocessing complete. Train samples: 2000, Val samples: 500
2025-06-30 01:34:28,217 - INFO - Loading model: bert-base-uncased
2025-06-30 01:34:30,963 - INFO - Model loaded and moved to device: cuda
2025-06-30 01:34:30,964 - INFO - Setting up training arguments
2025-06-30 01:34:31,065 - INFO - Setting up trainer
2025-06-30 01:34:31,102 - INFO - Starting training...
{'loss': 0.7021, 'grad_norm': 1.6418589353561401, 'learning_rate': 4.82e-05, 'epoch': 0.08}
{'loss': 0.6078, 'grad_norm': 3.696239471435547, 'learning_rate': 4.6200000000000005e-05, 'epoch': 0.16}
{'loss': 0.4514, 'grad_norm': 9.148458480834961, 'learning_rate': 4.4200000000000004e-05, 'epoch': 0.24}
{'loss': 0.3807, 'grad_norm': 26.13722038269043, 'learning_rate': 4.22e-05, 'epoch': 0.32}
{'loss': 0.4314, 'grad_norm': 4.6475911140441895, 'learning_rate': 4.02e-05, 'epoch': 0.4}
{'loss': 0.3594, 'grad_norm': 18.349842071533203, 'learning_rate': 3.82e-05, 'epoch': 0.48}
{'loss': 0.3636, 'grad_norm': 10.87183666229248, 'learning_rate': 3.62e-05, 'epoch': 0.56}
{'loss': 0.2937, 'grad_norm': 9.559141159057617, 'learning_rate': 3.4200000000000005e-05, 'epoch': 0.64}
{'loss': 0.365, 'grad_norm': 6.0772223472595215, 'learning_rate': 3.2200000000000003e-05, 'epoch': 0.72}
{'loss': 0.3441, 'grad_norm': 15.875909805297852, 'learning_rate': 3.02e-05, 'epoch': 0.8}
{'loss': 0.2869, 'grad_norm': 5.435507774353027, 'learning_rate': 2.8199999999999998e-05, 'epoch': 0.88}
{'loss': 0.4393, 'grad_norm': 8.466922760009766, 'learning_rate': 2.6200000000000003e-05, 'epoch': 0.96}
{'eval_loss': 0.3693428933620453, 'eval_accuracy': 0.834, 'eval_runtime': 0.47, 'eval_samples_per_second': 1063.779, 'eval_steps_per_second': 34.041, 'epoch': 1.0}
{'loss': 0.2699, 'grad_norm': 3.2011494636535645, 'learning_rate': 2.4200000000000002e-05, 'epoch': 1.04}
{'loss': 0.1151, 'grad_norm': 1.662684679031372, 'learning_rate': 2.22e-05, 'epoch': 1.12}
{'loss': 0.183, 'grad_norm': 2.9959988594055176, 'learning_rate': 2.0200000000000003e-05, 'epoch': 1.2}
{'loss': 0.2015, 'grad_norm': 2.522367477416992, 'learning_rate': 1.8200000000000002e-05, 'epoch': 1.28}
{'loss': 0.121, 'grad_norm': 0.6854217052459717, 'learning_rate': 1.62e-05, 'epoch': 1.36}
{'loss': 0.2419, 'grad_norm': 28.215795516967773, 'learning_rate': 1.42e-05, 'epoch': 1.44}
{'loss': 0.2623, 'grad_norm': 6.281438827514648, 'learning_rate': 1.22e-05, 'epoch': 1.52}
{'loss': 0.2196, 'grad_norm': 21.779531478881836, 'learning_rate': 1.02e-05, 'epoch': 1.6}
{'loss': 0.1618, 'grad_norm': 14.115859031677246, 'learning_rate': 8.200000000000001e-06, 'epoch': 1.68}
{'loss': 0.1269, 'grad_norm': 0.27107861638069153, 'learning_rate': 6.2e-06, 'epoch': 1.76}
{'loss': 0.195, 'grad_norm': 5.302858829498291, 'learning_rate': 4.2000000000000004e-06, 'epoch': 1.84}
{'loss': 0.0784, 'grad_norm': 1.586177110671997, 'learning_rate': 2.2e-06, 'epoch': 1.92}
{'loss': 0.0895, 'grad_norm': 10.106948852539062, 'learning_rate': 2.0000000000000002e-07, 'epoch': 2.0}
{'eval_loss': 0.34509924054145813, 'eval_accuracy': 0.902, 'eval_runtime': 0.4534, 'eval_samples_per_second': 1102.828, 'eval_steps_per_second': 35.29, 'epoch': 2.0}
{'train_runtime': 18.4638, 'train_samples_per_second': 216.64, 'train_steps_per_second': 13.54, 'train_loss': 0.291659961938858, 'epoch': 2.0}
2025-06-30 01:34:49,768 - INFO - Training completed successfully
2025-06-30 01:34:49,967 - INFO - Model moved to CPU and training finished for task: sst2
2025-06-30 01:34:49,969 - INFO - Starting training for task: qnli
2025-06-30 01:34:49,970 - INFO - Config: CFG(model_name='bert-base-uncased', tasks=['sst2', 'qnli'], train_size=2000, eval_size=500, device='cuda', epochs=2, batch_train=16, batch_eval=32)
2025-06-30 01:34:49,970 - INFO - CUDA available: Quadro RTX 8000
2025-06-30 01:34:50,217 - INFO - Tokenizer loaded successfully
2025-06-30 01:34:50,218 - INFO - Loading dataset: glue/qnli
2025-06-30 01:34:51,529 - INFO - Dataset loaded. Train size: 104743, Val size: 5463
2025-06-30 01:34:51,584 - INFO - Data preprocessing complete. Train samples: 2000, Val samples: 500
2025-06-30 01:34:51,585 - INFO - Loading model: bert-base-uncased
2025-06-30 01:34:51,929 - INFO - Model loaded and moved to device: cuda
2025-06-30 01:34:51,930 - INFO - Setting up training arguments
2025-06-30 01:34:52,019 - INFO - Setting up trainer
2025-06-30 01:34:52,034 - INFO - Starting training...
{'loss': 0.7156, 'grad_norm': 4.185510158538818, 'learning_rate': 4.82e-05, 'epoch': 0.08}
{'loss': 0.6707, 'grad_norm': 8.785157203674316, 'learning_rate': 4.6200000000000005e-05, 'epoch': 0.16}
{'loss': 0.594, 'grad_norm': 4.079275131225586, 'learning_rate': 4.4200000000000004e-05, 'epoch': 0.24}
{'loss': 0.6035, 'grad_norm': 6.96248197555542, 'learning_rate': 4.22e-05, 'epoch': 0.32}
{'loss': 0.5417, 'grad_norm': 11.418680191040039, 'learning_rate': 4.02e-05, 'epoch': 0.4}
{'loss': 0.5277, 'grad_norm': 15.635701179504395, 'learning_rate': 3.82e-05, 'epoch': 0.48}
{'loss': 0.5814, 'grad_norm': 3.7475790977478027, 'learning_rate': 3.62e-05, 'epoch': 0.56}
{'loss': 0.5731, 'grad_norm': 8.747978210449219, 'learning_rate': 3.4200000000000005e-05, 'epoch': 0.64}
{'loss': 0.5049, 'grad_norm': 6.660214900970459, 'learning_rate': 3.2200000000000003e-05, 'epoch': 0.72}
{'loss': 0.5228, 'grad_norm': 9.119773864746094, 'learning_rate': 3.02e-05, 'epoch': 0.8}
{'loss': 0.5214, 'grad_norm': 5.414433002471924, 'learning_rate': 2.8199999999999998e-05, 'epoch': 0.88}
{'loss': 0.5342, 'grad_norm': 8.350957870483398, 'learning_rate': 2.6200000000000003e-05, 'epoch': 0.96}
{'eval_loss': 0.43188872933387756, 'eval_accuracy': 0.818, 'eval_runtime': 0.9487, 'eval_samples_per_second': 527.051, 'eval_steps_per_second': 16.866, 'epoch': 1.0}
{'loss': 0.4513, 'grad_norm': 4.300283432006836, 'learning_rate': 2.4200000000000002e-05, 'epoch': 1.04}
{'loss': 0.3948, 'grad_norm': 22.732988357543945, 'learning_rate': 2.22e-05, 'epoch': 1.12}
{'loss': 0.4117, 'grad_norm': 21.633926391601562, 'learning_rate': 2.0200000000000003e-05, 'epoch': 1.2}
{'loss': 0.3476, 'grad_norm': 4.3360724449157715, 'learning_rate': 1.8200000000000002e-05, 'epoch': 1.28}
{'loss': 0.3332, 'grad_norm': 8.840799331665039, 'learning_rate': 1.62e-05, 'epoch': 1.36}
{'loss': 0.3146, 'grad_norm': 4.462144374847412, 'learning_rate': 1.42e-05, 'epoch': 1.44}
{'loss': 0.3259, 'grad_norm': 8.326566696166992, 'learning_rate': 1.22e-05, 'epoch': 1.52}
{'loss': 0.3616, 'grad_norm': 10.69599723815918, 'learning_rate': 1.02e-05, 'epoch': 1.6}
{'loss': 0.3706, 'grad_norm': 9.018745422363281, 'learning_rate': 8.200000000000001e-06, 'epoch': 1.68}
{'loss': 0.2977, 'grad_norm': 5.6575798988342285, 'learning_rate': 6.2e-06, 'epoch': 1.76}
{'loss': 0.3131, 'grad_norm': 7.533969879150391, 'learning_rate': 4.2000000000000004e-06, 'epoch': 1.84}
{'loss': 0.3772, 'grad_norm': 13.022882461547852, 'learning_rate': 2.2e-06, 'epoch': 1.92}
{'loss': 0.3374, 'grad_norm': 4.831995964050293, 'learning_rate': 2.0000000000000002e-07, 'epoch': 2.0}
{'eval_loss': 0.3866531252861023, 'eval_accuracy': 0.844, 'eval_runtime': 0.9451, 'eval_samples_per_second': 529.038, 'eval_steps_per_second': 16.929, 'epoch': 2.0}
{'train_runtime': 28.3081, 'train_samples_per_second': 141.302, 'train_steps_per_second': 8.831, 'train_loss': 0.46110140323638915, 'epoch': 2.0}
2025-06-30 01:35:20,618 - INFO - Training completed successfully
2025-06-30 01:35:20,816 - INFO - Model moved to CPU and training finished for task: qnli
Orthogonal accuracies [0.902, 0.454] [0.506, 0.844] [0.868, 0.684]
CL {'BWT': -0.03400000000000003, 'FWT': 0.23000000000000004, 'Retention%': 96.23059866962305, 'Transfer%': 150.66079295154185} {'BWT': -0.15999999999999992, 'FWT': 0.362, 'Retention%': 81.04265402843603, 'Transfer%': 171.54150197628456}

======== GPU REPORT ========

==============NVSMI LOG==============

Timestamp                                 : Mon Jun 30 01:35:31 2025
Driver Version                            : 570.133.20
CUDA Version                              : 12.8

Attached GPUs                             : 1
GPU 00000000:C3:00.0
    Accounting Mode                       : Enabled
    Accounting Mode Buffer Size           : 4000
    Accounted Processes
        Process ID                        : 3415529
            GPU Utilization               : 60 %
            Memory Utilization            : 33 %
            Max memory usage              : 7510 MiB
            Time                          : 71036 ms
            Is Running                    : 0

Mon Jun 30 01:35:31 2025       
+-----------------------------------------------------------------------------------------+
| NVIDIA-SMI 570.133.20             Driver Version: 570.133.20     CUDA Version: 12.8     |
|-----------------------------------------+------------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id          Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |           Memory-Usage | GPU-Util  Compute M. |
|                                         |                        |               MIG M. |
|=========================================+========================+======================|
|   0  Quadro RTX 8000                On  |   00000000:C3:00.0 Off |                    0 |
| 34%   43C    P2             79W /  260W |       1MiB /  46080MiB |     34%      Default |
|                                         |                        |                  N/A |
+-----------------------------------------+------------------------+----------------------+
                                                                                         
+-----------------------------------------------------------------------------------------+
| Processes:                                                                              |
|  GPU   GI   CI              PID   Type   Process name                        GPU Memory |
|        ID   ID                                                               Usage      |
|=========================================================================================|
|  No running processes found                                                             |
+-----------------------------------------------------------------------------------------+
